name: RunwayML Video Automation for USA Market

on:
  schedule:
    - cron: '0 */6 * * *'  # 每6小时运行一次
  workflow_dispatch:

jobs:
  generate_and_publish:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    
    - name: Install dependencies
      run: |
        pip install requests openai elevenlabs youtube-api-python tiktok-api
    
    - name: Generate content for USA market
      env:
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        RUNWAYML_API_KEY: ${{ secrets.RUNWAYML_API_KEY }}
        ELEVENLABS_API_KEY: ${{ secrets.ELEVENLABS_API_KEY }}
      run: |
        python scripts/generate_usa_content.py
    
    - name: Upload to YouTube
      env:
        YOUTUBE_API_KEY: ${{ secrets.YOUTUBE_API_KEY }}
      run: |
        python scripts/upload_youtube.py
    
    - name: Upload to TikTok
      env:
        TIKTOK_API_KEY: ${{ secrets.TIKTOK_API_KEY }}
      run: |
        python scripts/upload_tiktok.py
